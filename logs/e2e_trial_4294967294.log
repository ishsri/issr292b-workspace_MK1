Hi, I am step  in this array job 
Activate ml_pipeline_x86_64
Load modenv/hiera  GCC/10.2.0  CUDA/11.1.1 OpenMPI/4.0.5
Module GCC/10.2.0CUDA/11.1.1OpenMPI/4.0.5 and 15 dependencies loaded.
Check Python: /beegfs/ws/1/issr292b-workspace_MK1/issr292b-workspace_MK1/envs/final/bin/python
Torch v1.13.0, Torchvision v0.14.0
Cuda available: True
Run script
mds_eb_vs_d_e2e_bg cv0
python /beegfs/ws/1/issr292b-workspace_MK1/issr292b-workspace_MK1/pytorch_hyper_classification/hyper_classification/hyper_wsi.py -j 4 --no-log-roc --no-log-model -b 2 --epochs 30 --input-size 1920 2560 --class-names d mds_eb --data-paths /beegfs/ws/1/issr292b-workspace_MK1/model_files/mds_eb_vs_d_e2e_bg/base_config/trainval/cv{cv}/train.csv /beegfs/ws/1/issr292b-workspace_MK1/model_files/mds_eb_vs_d_e2e_bg/base_config/trainval/cv{cv}/val.csv --experiment-name mds_eb_vs_d_e2e_bg_pytorch01 --output-dir /beegfs/ws/1/issr292b-workspace_MK1/output_mds
[32m[I 2023-10-25 13:00:39,531][0m A new study created in memory with name: mds_eb_vs_d_e2e_bg_pytorch01[0m
2023/10/25 13:00:39 INFO mlflow.tracking.fluent: Experiment with name 'mds_eb_vs_d_e2e_bg_pytorch01' does not exist. Creating a new experiment.
Log Model: False
Log Roc: False
Min memory: 30.996758939325684 GB
Finished trial None
Free memory: 42505142272
START CV 0
Initialized mlflow: 
  http://taurusi8033.taurus.hrsk.tu-dresden.de:5000
  None
  mds_eb_vs_d_e2e_bg_pytorch01
Set active experiment to mds_eb_vs_d_e2e_bg_pytorch01
Create new run default
  2
Namespace(balance_samples=True, balance_val_set=False, batch_size=2, class_names=['d', 'mds_eb'], cv_start=0, data_path=None, data_paths=['/beegfs/ws/1/issr292b-workspace_MK1/model_files/mds_eb_vs_d_e2e_bg/base_config/trainval/cv{cv}/train.csv', '/beegfs/ws/1/issr292b-workspace_MK1/model_files/mds_eb_vs_d_e2e_bg/base_config/trainval/cv{cv}/val.csv'], dataset_type='binary', device='cuda', dist_url='env://', distributed=False, epochs=30, experiment_name='mds_eb_vs_d_e2e_bg_pytorch01', imgs_path='/', input_size=[1920, 2560], log_model=False, log_roc=False, lr=0.003496105771258525, lr_gamma=0.01205779236339698, lr_step_size=4.0, min_memory=None, model='densenet121', momentum=0.8270353942194384, name='0', nr_cv=5, output_dir='/beegfs/ws/1/issr292b-workspace_MK1/output_mds/0', pretrained=True, print_freq=10, resume='', run_name='default', run_uuid=None, start_epoch=0, sync_bn=False, system_attr={}, test_only=False, test_split=0.2, user_attr={}, weight_decay=0.0002, workers=4, world_size=1)
Loading data
Loading training data
Took 0.018177270889282227
Loading validation data
Creating data loaders
Using Train imbalancedDatasetSampler with weights: tensor([0.0014, 0.0014, 0.0014,  ..., 0.0014, 0.0014, 0.0014],
       dtype=torch.float64)
Creating model
Device: cuda
Start training
Total epochs 30
Epoch 0
#### 25.10.23 13:00 - Start Epoch 0 train
/beegfs/ws/1/issr292b-workspace_MK1/issr292b-workspace_MK1/envs/final/lib/python3.7/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
/beegfs/ws/1/issr292b-workspace_MK1/issr292b-workspace_MK1/envs/final/lib/python3.7/site-packages/torchvision/models/_utils.py:209: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  f"The parameter '{pretrained_param}' is deprecated since 0.13 and may be removed in the future, "
/beegfs/ws/1/issr292b-workspace_MK1/issr292b-workspace_MK1/envs/final/lib/python3.7/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Epoch: [0] Batch:  [  0/701]  eta: 2:36:19  lr: 0.003496105771258525  labelBalance: 2.0  img/s: 0.24866688430852865  loss: 0.7159 (0.7159)  acc1: 0.0000 (0.0000)  f1_score: 0.0000 (0.0000)  time: 13.3804  data: 5.3375  max mem: 24493
Epoch: [0] Batch:  [ 10/701]  eta: 0:18:29  lr: 0.003496105771258525  labelBalance: 1.1818182468414307  img/s: 5.247451842417706  loss: 1.4174 (1.6431)  acc1: 50.0000 (50.0000)  f1_score: 0.5000 (0.5000)  time: 1.6050  data: 0.5177  max mem: 24540
Epoch: [0] Batch:  [ 20/701]  eta: 0:13:47  lr: 0.003496105771258525  labelBalance: 1.0952380895614624  img/s: 5.478997392635633  loss: 1.0557 (1.4022)  acc1: 50.0000 (45.2381)  f1_score: 0.5000 (0.4524)  time: 0.6063  data: 0.2209  max mem: 24540
Epoch: [0] Batch:  [ 30/701]  eta: 0:12:28  lr: 0.003496105771258525  labelBalance: 1.193548321723938  img/s: 5.1289594005153045  loss: 0.9877 (1.2563)  acc1: 50.0000 (46.7742)  f1_score: 0.5000 (0.4677)  time: 0.8472  data: 0.4677  max mem: 24540
Epoch: [0] Batch:  [ 40/701]  eta: 0:11:26  lr: 0.003496105771258525  labelBalance: 1.1219512224197388  img/s: 5.489032219226055  loss: 1.0861 (1.2941)  acc1: 50.0000 (45.1220)  f1_score: 0.5000 (0.4512)  time: 0.8523  data: 0.4702  max mem: 24540
Epoch: [0] Batch:  [ 50/701]  eta: 0:11:01  lr: 0.003496105771258525  labelBalance: 1.0784313678741455  img/s: 5.347861870940226  loss: 0.9891 (1.2183)  acc1: 50.0000 (44.1176)  f1_score: 0.5000 (0.4412)  time: 0.8608  data: 0.4742  max mem: 24540
Epoch: [0] Batch:  [ 60/701]  eta: 0:10:28  lr: 0.003496105771258525  labelBalance: 1.0819671154022217  img/s: 4.945486273850897  loss: 0.9891 (1.2285)  acc1: 50.0000 (44.2623)  f1_score: 0.5000 (0.4426)  time: 0.8614  data: 0.4686  max mem: 24540
Epoch: [0] Batch:  [ 70/701]  eta: 0:10:12  lr: 0.003496105771258525  labelBalance: 1.1408450603485107  img/s: 5.318802582615218  loss: 1.0649 (1.2491)  acc1: 50.0000 (44.3662)  f1_score: 0.5000 (0.4437)  time: 0.8538  data: 0.4589  max mem: 24540
Epoch: [0] Batch:  [ 80/701]  eta: 0:09:50  lr: 0.003496105771258525  labelBalance: 1.1111111640930176  img/s: 4.81891488062446  loss: 1.0089 (1.2059)  acc1: 50.0000 (46.9136)  f1_score: 0.5000 (0.4691)  time: 0.8629  data: 0.4662  max mem: 24540
Epoch: [0] Batch:  [ 90/701]  eta: 0:09:38  lr: 0.003496105771258525  labelBalance: 1.0989011526107788  img/s: 5.17910578612609  loss: 0.8859 (1.1821)  acc1: 50.0000 (45.0549)  f1_score: 0.5000 (0.4505)  time: 0.8629  data: 0.4669  max mem: 24540
Epoch: [0] Batch:  [100/701]  eta: 0:09:20  lr: 0.003496105771258525  labelBalance: 1.089108943939209  img/s: 4.947808181930249  loss: 0.8859 (1.1505)  acc1: 50.0000 (44.5545)  f1_score: 0.5000 (0.4455)  time: 0.8590  data: 0.4642  max mem: 24540
Epoch: [0] Batch:  [110/701]  eta: 0:09:10  lr: 0.003496105771258525  labelBalance: 1.072072148323059  img/s: 5.29387323392579  loss: 0.9176 (1.1490)  acc1: 50.0000 (44.5946)  f1_score: 0.5000 (0.4459)  time: 0.8619  data: 0.4679  max mem: 24540
Epoch: [0] Batch:  [120/701]  eta: 0:08:58  lr: 0.003496105771258525  labelBalance: 1.0578511953353882  img/s: 4.761682248295671  loss: 0.9841 (1.1363)  acc1: 50.0000 (44.6281)  f1_score: 0.5000 (0.4463)  time: 0.8944  data: 0.4946  max mem: 24540
Epoch: [0] Batch:  [130/701]  eta: 0:08:51  lr: 0.003496105771258525  labelBalance: 1.0610686540603638  img/s: 5.409164477493755  loss: 0.8234 (1.1182)  acc1: 50.0000 (45.4198)  f1_score: 0.5000 (0.4542)  time: 0.9286  data: 0.5251  max mem: 24540
Epoch: [0] Batch:  [140/701]  eta: 0:08:39  lr: 0.003496105771258525  labelBalance: 1.042553186416626  img/s: 4.736409781546957  loss: 0.7332 (1.1102)  acc1: 50.0000 (45.7447)  f1_score: 0.5000 (0.4574)  time: 0.9220  data: 0.5208  max mem: 24540
Epoch: [0] Batch:  [150/701]  eta: 0:08:32  lr: 0.003496105771258525  labelBalance: 1.0331125259399414  img/s: 5.1680180288409705  loss: 0.8827 (1.0906)  acc1: 50.0000 (45.3642)  f1_score: 0.5000 (0.4536)  time: 0.9271  data: 0.5251  max mem: 24540
Epoch: [0] Batch:  [160/701]  eta: 0:08:21  lr: 0.003496105771258525  labelBalance: 1.0310559272766113  img/s: 4.6940120990192415  loss: 0.7995 (1.0687)  acc1: 50.0000 (45.6522)  f1_score: 0.5000 (0.4565)  time: 0.9276  data: 0.5261  max mem: 24540
Epoch: [0] Batch:  [170/701]  eta: 0:08:13  lr: 0.003496105771258525  labelBalance: 1.0350877046585083  img/s: 5.007804277577492  loss: 0.7525 (1.0511)  acc1: 50.0000 (45.6140)  f1_score: 0.5000 (0.4561)  time: 0.9242  data: 0.5256  max mem: 24540
Epoch: [0] Batch:  [180/701]  eta: 0:08:01  lr: 0.003496105771258525  labelBalance: 1.044198989868164  img/s: 5.115310549045004  loss: 0.7525 (1.0340)  acc1: 50.0000 (46.4088)  f1_score: 0.5000 (0.4641)  time: 0.9067  data: 0.5128  max mem: 24540
Epoch: [0] Batch:  [190/701]  eta: 0:07:54  lr: 0.003496105771258525  labelBalance: 1.036649227142334  img/s: 4.728786969156316  loss: 0.6781 (1.0270)  acc1: 50.0000 (46.5969)  f1_score: 0.5000 (0.4660)  time: 0.9180  data: 0.5214  max mem: 24540
Epoch: [0] Batch:  [200/701]  eta: 0:07:42  lr: 0.003496105771258525  labelBalance: 1.039801001548767  img/s: 5.505047568484903  loss: 0.8831 (1.0230)  acc1: 50.0000 (45.5224)  f1_score: 0.5000 (0.4552)  time: 0.9135  data: 0.5138  max mem: 24540
Epoch: [0] Batch:  [210/701]  eta: 0:07:35  lr: 0.003496105771258525  labelBalance: 1.0331753492355347  img/s: 4.645598326642525  loss: 0.8831 (1.0152)  acc1: 50.0000 (45.4976)  f1_score: 0.5000 (0.4550)  time: 0.9188  data: 0.5110  max mem: 24540
Epoch: [0] Batch:  [220/701]  eta: 0:07:23  lr: 0.003496105771258525  labelBalance: 1.0407240390777588  img/s: 5.278191098448621  loss: 0.8522 (1.0195)  acc1: 50.0000 (45.4751)  f1_score: 0.5000 (0.4548)  time: 0.9174  data: 0.5067  max mem: 24540
Epoch: [0] Batch:  [230/701]  eta: 0:07:16  lr: 0.003496105771258525  labelBalance: 1.0346320867538452  img/s: 4.826903490792837  loss: 0.8522 (1.0192)  acc1: 50.0000 (45.4545)  f1_score: 0.5000 (0.4545)  time: 0.9139  data: 0.5083  max mem: 24540
Epoch: [0] Batch:  [240/701]  eta: 0:07:04  lr: 0.003496105771258525  labelBalance: 1.0331950187683105  img/s: 5.072154451266888  loss: 0.7427 (1.0079)  acc1: 50.0000 (45.0207)  f1_score: 0.5000 (0.4502)  time: 0.9134  data: 0.4991  max mem: 24540
Epoch: [0] Batch:  [250/701]  eta: 0:06:57  lr: 0.003496105771258525  labelBalance: 1.0438246726989746  img/s: 4.508087152184205  loss: 0.7279 (1.0016)  acc1: 50.0000 (45.6175)  f1_score: 0.5000 (0.4562)  time: 0.9156  data: 0.4969  max mem: 24540
Epoch: [0] Batch:  [260/701]  eta: 0:06:46  lr: 0.003496105771258525  labelBalance: 1.034482717514038  img/s: 5.015403250927166  loss: 1.2734 (1.0349)  acc1: 50.0000 (45.4023)  f1_score: 0.5000 (0.4540)  time: 0.9296  data: 0.5213  max mem: 24540
Epoch: [0] Batch:  [270/701]  eta: 0:06:38  lr: 0.003496105771258525  labelBalance: 1.0221402645111084  img/s: 4.691407929962826  loss: 1.3077 (1.0431)  acc1: 50.0000 (45.3875)  f1_score: 0.5000 (0.4539)  time: 0.9262  data: 0.5250  max mem: 24540
Epoch: [0] Batch:  [280/701]  eta: 0:06:27  lr: 0.003496105771258525  labelBalance: 1.0177935361862183  img/s: 4.640633133865482  loss: 0.9410 (1.0398)  acc1: 50.0000 (45.3737)  f1_score: 0.5000 (0.4537)  time: 0.9095  data: 0.5077  max mem: 24540
Epoch: [0] Batch:  [290/701]  eta: 0:06:19  lr: 0.003496105771258525  labelBalance: 1.0274914503097534  img/s: 4.7891089351969995  loss: 0.7688 (1.0379)  acc1: 50.0000 (45.7045)  f1_score: 0.5000 (0.4570)  time: 0.9045  data: 0.5031  max mem: 24540
Epoch: [0] Batch:  [300/701]  eta: 0:06:08  lr: 0.003496105771258525  labelBalance: 1.0199335813522339  img/s: 4.729202853326974  loss: 0.7469 (1.0252)  acc1: 50.0000 (46.3455)  f1_score: 0.5000 (0.4635)  time: 0.9033  data: 0.5022  max mem: 24540
Epoch: [0] Batch:  [310/701]  eta: 0:06:00  lr: 0.003496105771258525  labelBalance: 1.0032154321670532  img/s: 4.86710595863956  loss: 0.6585 (1.0141)  acc1: 50.0000 (46.9453)  f1_score: 0.5000 (0.4695)  time: 0.9084  data: 0.5093  max mem: 24540
Epoch: [0] Batch:  [320/701]  eta: 0:05:50  lr: 0.003496105771258525  labelBalance: 1.0124610662460327  img/s: 4.708365723920503  loss: 0.6585 (1.0045)  acc1: 50.0000 (47.1963)  f1_score: 0.5000 (0.4720)  time: 0.9109  data: 0.5142  max mem: 24540
Epoch: [0] Batch:  [330/701]  eta: 0:05:42  lr: 0.003496105771258525  labelBalance: 1.0151057243347168  img/s: 4.9547109164074215  loss: 0.7364 (1.0037)  acc1: 50.0000 (46.8278)  f1_score: 0.5000 (0.4683)  time: 0.9099  data: 0.5136  max mem: 24540
Epoch: [0] Batch:  [340/701]  eta: 0:05:31  lr: 0.003496105771258525  labelBalance: 1.0175952911376953  img/s: 4.716145499522123  loss: 0.7597 (0.9968)  acc1: 50.0000 (47.0674)  f1_score: 0.5000 (0.4707)  time: 0.9150  data: 0.5160  max mem: 24540
Epoch: [0] Batch:  [350/701]  eta: 0:05:23  lr: 0.003496105771258525  labelBalance: 1.0170940160751343  img/s: 4.522543417421312  loss: 0.7545 (0.9927)  acc1: 50.0000 (47.1510)  f1_score: 0.5000 (0.4715)  time: 0.9051  data: 0.5030  max mem: 24540
Epoch: [0] Batch:  [360/701]  eta: 0:05:13  lr: 0.003496105771258525  labelBalance: 1.0221606492996216  img/s: 4.864483954397318  loss: 0.7417 (0.9872)  acc1: 50.0000 (47.0914)  f1_score: 0.5000 (0.4709)  time: 0.9026  data: 0.4941  max mem: 24540
Epoch: [0] Batch:  [370/701]  eta: 0:05:04  lr: 0.003496105771258525  labelBalance: 1.026954174041748  img/s: 4.762514888877029  loss: 0.7417 (0.9810)  acc1: 50.0000 (47.3046)  f1_score: 0.5000 (0.4730)  time: 0.9116  data: 0.4988  max mem: 24540
Epoch: [0] Batch:  [380/701]  eta: 0:04:54  lr: 0.003496105771258525  labelBalance: 1.0288714170455933  img/s: 4.86491276500486  loss: 0.7604 (0.9745)  acc1: 50.0000 (47.5066)  f1_score: 0.5000 (0.4751)  time: 0.9097  data: 0.5024  max mem: 24540
Epoch: [0] Batch:  [390/701]  eta: 0:04:46  lr: 0.003496105771258525  labelBalance: 1.0255753993988037  img/s: 4.774604677953831  loss: 0.7604 (0.9697)  acc1: 50.0000 (47.4425)  f1_score: 0.5000 (0.4744)  time: 0.9206  data: 0.5145  max mem: 24540
Epoch: [0] Batch:  [400/701]  eta: 0:04:36  lr: 0.003496105771258525  labelBalance: 1.032418966293335  img/s: 4.76482239145166  loss: 0.7445 (0.9623)  acc1: 50.0000 (47.8803)  f1_score: 0.5000 (0.4788)  time: 0.9196  data: 0.5149  max mem: 24540
Epoch: [0] Batch:  [410/701]  eta: 0:04:27  lr: 0.003496105771258525  labelBalance: 1.0316301584243774  img/s: 4.714571060207026  loss: 0.7431 (0.9605)  acc1: 50.0000 (47.6886)  f1_score: 0.5000 (0.4769)  time: 0.9108  data: 0.5098  max mem: 24540
Epoch: [0] Batch:  [420/701]  eta: 0:04:17  lr: 0.003496105771258525  labelBalance: 1.0403801202774048  img/s: 4.7608201774224765  loss: 0.7662 (0.9598)  acc1: 50.0000 (47.9810)  f1_score: 0.5000 (0.4798)  time: 0.9135  data: 0.5126  max mem: 24540
Epoch: [0] Batch:  [430/701]  eta: 0:04:09  lr: 0.003496105771258525  labelBalance: 1.0371229648590088  img/s: 4.640622864973084  loss: 0.7352 (0.9559)  acc1: 50.0000 (47.9118)  f1_score: 0.5000 (0.4791)  time: 0.9041  data: 0.4984  max mem: 24540
Epoch: [0] Batch:  [440/701]  eta: 0:03:59  lr: 0.003496105771258525  labelBalance: 1.043083906173706  img/s: 4.597580799859693  loss: 0.7352 (0.9516)  acc1: 50.0000 (48.2993)  f1_score: 0.5000 (0.4830)  time: 0.9032  data: 0.4938  max mem: 24540
Epoch: [0] Batch:  [450/701]  eta: 0:03:50  lr: 0.003496105771258525  labelBalance: 1.0443458557128906  img/s: 4.643798116818377  loss: 0.7732 (0.9496)  acc1: 50.0000 (48.4479)  f1_score: 0.5000 (0.4845)  time: 0.9110  data: 0.5039  max mem: 24540
Epoch: [0] Batch:  [460/701]  eta: 0:03:40  lr: 0.003496105771258525  labelBalance: 1.0433839559555054  img/s: 4.84191496902161  loss: 0.7768 (0.9468)  acc1: 50.0000 (47.9393)  f1_score: 0.5000 (0.4794)  time: 0.9099  data: 0.5033  max mem: 24540
Epoch: [0] Batch:  [470/701]  eta: 0:03:32  lr: 0.003496105771258525  labelBalance: 1.042462944984436  img/s: 4.736431175970395  loss: 0.7403 (0.9436)  acc1: 50.0000 (47.6645)  f1_score: 0.5000 (0.4766)  time: 0.9159  data: 0.5079  max mem: 24540
Epoch: [0] Batch:  [480/701]  eta: 0:03:22  lr: 0.003496105771258525  labelBalance: 1.0457381010055542  img/s: 4.7873187479455055  loss: 0.7375 (0.9419)  acc1: 50.0000 (47.9210)  f1_score: 0.5000 (0.4792)  time: 0.9159  data: 0.5135  max mem: 24540
Epoch: [0] Batch:  [490/701]  eta: 0:03:13  lr: 0.003496105771258525  labelBalance: 1.0448065996170044  img/s: 4.925904220773501  loss: 0.7916 (0.9391)  acc1: 50.0000 (47.7597)  f1_score: 0.5000 (0.4776)  time: 0.9090  data: 0.5074  max mem: 24540
Epoch: [0] Batch:  [500/701]  eta: 0:03:04  lr: 0.003496105771258525  labelBalance: 1.0419161319732666  img/s: 4.6988816598375  loss: 0.7266 (0.9353)  acc1: 50.0000 (47.9042)  f1_score: 0.5000 (0.4790)  time: 0.9127  data: 0.5084  max mem: 24540
Epoch: [0] Batch:  [510/701]  eta: 0:02:55  lr: 0.003496105771258525  labelBalance: 1.0469666719436646  img/s: 5.133793309416536  loss: 0.6734 (0.9298)  acc1: 50.0000 (47.9452)  f1_score: 0.5000 (0.4795)  time: 0.9143  data: 0.5129  max mem: 24540
Epoch: [0] Batch:  [520/701]  eta: 0:02:45  lr: 0.003496105771258525  labelBalance: 1.0479846000671387  img/s: 4.950085534441259  loss: 0.8103 (0.9372)  acc1: 50.0000 (47.6967)  f1_score: 0.5000 (0.4770)  time: 0.9117  data: 0.5122  max mem: 24540
Epoch: [0] Batch:  [530/701]  eta: 0:02:37  lr: 0.003496105771258525  labelBalance: 1.0470809936523438  img/s: 5.206024599600205  loss: 0.8206 (0.9353)  acc1: 50.0000 (47.7401)  f1_score: 0.5000 (0.4774)  time: 0.9125  data: 0.5159  max mem: 24540
Epoch: [0] Batch:  [540/701]  eta: 0:02:27  lr: 0.003496105771258525  labelBalance: 1.046210765838623  img/s: 4.683121162232037  loss: 0.7914 (0.9329)  acc1: 50.0000 (47.7819)  f1_score: 0.5000 (0.4778)  time: 0.9062  data: 0.5017  max mem: 24540
Epoch: [0] Batch:  [550/701]  eta: 0:02:18  lr: 0.003496105771258525  labelBalance: 1.0453720092773438  img/s: 4.587827169365949  loss: 0.6798 (0.9294)  acc1: 50.0000 (47.8221)  f1_score: 0.5000 (0.4782)  time: 0.9004  data: 0.4917  max mem: 24540
Epoch: [0] Batch:  [560/701]  eta: 0:02:09  lr: 0.003496105771258525  labelBalance: 1.048128366470337  img/s: 4.784389010847365  loss: 0.7008 (0.9271)  acc1: 50.0000 (47.8610)  f1_score: 0.5000 (0.4786)  time: 0.9223  data: 0.5184  max mem: 24540
Epoch: [0] Batch:  [570/701]  eta: 0:02:00  lr: 0.003496105771258525  labelBalance: 1.0437828302383423  img/s: 5.0073409412975405  loss: 0.7676 (0.9247)  acc1: 50.0000 (47.9860)  f1_score: 0.5000 (0.4799)  time: 0.9219  data: 0.5210  max mem: 24540
Epoch: [0] Batch:  [580/701]  eta: 0:01:50  lr: 0.003496105771258525  labelBalance: 1.0395869016647339  img/s: 4.675517625000278  loss: 0.7698 (0.9223)  acc1: 50.0000 (47.8485)  f1_score: 0.5000 (0.4785)  time: 0.9077  data: 0.5110  max mem: 24540
Epoch: [0] Batch:  [590/701]  eta: 0:01:41  lr: 0.003496105771258525  labelBalance: 1.0372250080108643  img/s: 4.593907325677741  loss: 0.7442 (0.9227)  acc1: 50.0000 (47.9695)  f1_score: 0.5000 (0.4797)  time: 0.8989  data: 0.4964  max mem: 24540
Epoch: [0] Batch:  [600/701]  eta: 0:01:32  lr: 0.003496105771258525  labelBalance: 1.0366055965423584  img/s: 4.7769211933465066  loss: 0.7783 (0.9312)  acc1: 50.0000 (48.0033)  f1_score: 0.5000 (0.4800)  time: 0.9084  data: 0.4982  max mem: 24540
Epoch: [0] Batch:  [610/701]  eta: 0:01:23  lr: 0.003496105771258525  labelBalance: 1.0327332019805908  img/s: 4.960523880400196  loss: 0.7325 (0.9290)  acc1: 50.0000 (48.2815)  f1_score: 0.5000 (0.4828)  time: 0.9297  data: 0.5177  max mem: 24540
Epoch: [0] Batch:  [620/701]  eta: 0:01:14  lr: 0.003496105771258525  labelBalance: 1.0273752212524414  img/s: 4.685716137010956  loss: 0.8203 (0.9309)  acc1: 50.0000 (48.2287)  f1_score: 0.5000 (0.4823)  time: 0.9204  data: 0.5120  max mem: 24540
Epoch: [0] Batch:  [630/701]  eta: 0:01:05  lr: 0.003496105771258525  labelBalance: 1.025356650352478  img/s: 4.826428592387937  loss: 0.8605 (0.9293)  acc1: 50.0000 (48.2567)  f1_score: 0.5000 (0.4826)  time: 0.9129  data: 0.5046  max mem: 24540
Epoch: [0] Batch:  [640/701]  eta: 0:00:55  lr: 0.003496105771258525  labelBalance: 1.0280811786651611  img/s: 4.802153370394477  loss: 0.7677 (0.9267)  acc1: 50.0000 (48.1279)  f1_score: 0.5000 (0.4813)  time: 0.9082  data: 0.5010  max mem: 24540
Epoch: [0] Batch:  [650/701]  eta: 0:00:46  lr: 0.003496105771258525  labelBalance: 1.0307220220565796  img/s: 4.538214427532869  loss: 0.6786 (0.9263)  acc1: 50.0000 (48.3103)  f1_score: 0.5000 (0.4831)  time: 0.9092  data: 0.5062  max mem: 24540
Epoch: [0] Batch:  [660/701]  eta: 0:00:37  lr: 0.003496105771258525  labelBalance: 1.0332828760147095  img/s: 4.699108029637862  loss: 0.6896 (0.9240)  acc1: 50.0000 (48.3359)  f1_score: 0.5000 (0.4834)  time: 0.9149  data: 0.5103  max mem: 24540
Epoch: [0] Batch:  [670/701]  eta: 0:00:28  lr: 0.003496105771258525  labelBalance: 1.0312966108322144  img/s: 4.6877480825381745  loss: 0.6961 (0.9213)  acc1: 50.0000 (48.4352)  f1_score: 0.5000 (0.4844)  time: 0.9134  data: 0.5089  max mem: 24540
Epoch: [0] Batch:  [680/701]  eta: 0:00:19  lr: 0.003496105771258525  labelBalance: 1.0279000997543335  img/s: 4.593522441903381  loss: 0.7103 (0.9185)  acc1: 50.0000 (48.6050)  f1_score: 0.5000 (0.4860)  time: 0.9059  data: 0.5025  max mem: 24540
Epoch: [0] Batch:  [690/701]  eta: 0:00:10  lr: 0.003496105771258525  labelBalance: 1.027496337890625  img/s: 4.71713735276884  loss: 0.7074 (0.9165)  acc1: 50.0000 (48.4805)  f1_score: 0.5000 (0.4848)  time: 0.9069  data: 0.5036  max mem: 24540
Epoch: [0] Batch:  [700/701]  eta: 0:00:00  lr: 0.003496105771258525  labelBalance: 1.0256776809692383  img/s: 6.375664178554301  loss: 0.7281 (0.9137)  acc1: 50.0000 (48.4308)  f1_score: 0.5000 (0.4843)  time: 0.8749  data: 0.4891  max mem: 24540
Epoch: [0] Batch: Total time: 0:10:41
#### 25.10.23 13:11 - End Epoch 0 train
Test:  [  0/176]  eta: 0:10:24  loss: 0.2898 (0.2898)  acc1: 100.0000 (100.0000)  f1_score: 1.0000 (1.0000)  time: 3.5492  data: 3.4168  max mem: 24540
Test:  [100/176]  eta: 0:00:55  loss: 1.1972 (0.4349)  acc1: 0.0000 (85.1485)  f1_score: 0.0000 (0.8515)  time: 0.6971  data: 0.5850  max mem: 24540
Test: Total time: 0:02:04
tensor([[172.,   0.],
        [180.,   0.]])
Traceback (most recent call last):
  File "/beegfs/.global1/ws/issr292b-workspace_MK1/issr292b-workspace_MK1/pytorch_hyper_classification/hyper_classification/cv_train.py", line 646, in main
    return inner_main(args, trial, cv, resume)
  File "/beegfs/.global1/ws/issr292b-workspace_MK1/issr292b-workspace_MK1/pytorch_hyper_classification/hyper_classification/cv_train.py", line 557, in inner_main
    loss, acc, f1_score, recall_per_class, precision_per_class, f1_per_class = evaluate(model, criterion, data_loader_test, device=device, class_names=class_names, cv_str=cv_str(cv))
  File "/beegfs/.global1/ws/issr292b-workspace_MK1/issr292b-workspace_MK1/pytorch_hyper_classification/hyper_classification/cv_train.py", line 358, in evaluate
    f1 = 2*(precision_per_class[i].item()*recall_per_class[i].item()) / (precision_per_class[i].item()+recall_per_class[i].item())
ZeroDivisionError: float division by zero

float division by zero
END CV 0
START CV 1
Initialized mlflow: 
  http://taurusi8033.taurus.hrsk.tu-dresden.de:5000
  None
  mds_eb_vs_d_e2e_bg_pytorch01
Set active experiment to mds_eb_vs_d_e2e_bg_pytorch01
Create new run default
  2
Namespace(balance_samples=True, balance_val_set=False, batch_size=2, class_names=['d', 'mds_eb'], cv_start=0, data_path=None, data_paths=['/beegfs/ws/1/issr292b-workspace_MK1/model_files/mds_eb_vs_d_e2e_bg/base_config/trainval/cv{cv}/train.csv', '/beegfs/ws/1/issr292b-workspace_MK1/model_files/mds_eb_vs_d_e2e_bg/base_config/trainval/cv{cv}/val.csv'], dataset_type='binary', device='cuda', dist_url='env://', distributed=False, epochs=30, experiment_name='mds_eb_vs_d_e2e_bg_pytorch01', imgs_path='/', input_size=[1920, 2560], log_model=False, log_roc=False, lr=0.003496105771258525, lr_gamma=0.01205779236339698, lr_step_size=4.0, min_memory=None, model='densenet121', momentum=0.8270353942194384, name='0', nr_cv=5, output_dir='/beegfs/ws/1/issr292b-workspace_MK1/output_mds/0', pretrained=True, print_freq=10, resume='', run_name='default', run_uuid=None, start_epoch=0, sync_bn=False, system_attr={}, test_only=False, test_split=0.2, user_attr={}, weight_decay=0.0002, workers=4, world_size=1)
Loading data
Loading training data
Took 0.012209177017211914
Loading validation data
Creating data loaders
Using Train imbalancedDatasetSampler with weights: tensor([0.0015, 0.0015, 0.0015,  ..., 0.0014, 0.0014, 0.0014],
       dtype=torch.float64)
Creating model
Device: cuda
Start training
Total epochs 30
Epoch 0
#### 25.10.23 13:13 - Start Epoch 0 train
